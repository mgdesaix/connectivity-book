<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Breeding nodes | Creating Migratory Networks in R</title>
  <meta name="description" content="This provides examples and documentation of the Mignette R package" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Breeding nodes | Creating Migratory Networks in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides examples and documentation of the Mignette R package" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Breeding nodes | Creating Migratory Networks in R" />
  
  <meta name="twitter:description" content="This provides examples and documentation of the Mignette R package" />
  

<meta name="author" content="Matt DeSaix" />


<meta name="date" content="2023-05-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quickstart.html"/>
<link rel="next" href="wintering.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Migratory Networks in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quickstart.html"><a href="quickstart.html"><i class="fa fa-check"></i><b>2</b> Quick start example</a></li>
<li class="chapter" data-level="3" data-path="breeding.html"><a href="breeding.html"><i class="fa fa-check"></i><b>3</b> Breeding nodes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="breeding.html"><a href="breeding.html#ebirdst"><i class="fa fa-check"></i><b>3.1</b> ebirdst</a></li>
<li class="chapter" data-level="3.2" data-path="breeding.html"><a href="breeding.html#creating-the-genoscape"><i class="fa fa-check"></i><b>3.2</b> Creating the genoscape</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="breeding.html"><a href="breeding.html#genoscape-polygons"><i class="fa fa-check"></i><b>3.2.1</b> Genoscape polygons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wintering.html"><a href="wintering.html"><i class="fa fa-check"></i><b>4</b> Nonbreeding nodes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wintering.html"><a href="wintering.html#subsetting-ecoregions"><i class="fa fa-check"></i><b>4.1</b> Subsetting ecoregions</a></li>
<li class="chapter" data-level="4.2" data-path="wintering.html"><a href="wintering.html#snap-points"><i class="fa fa-check"></i><b>4.2</b> Snap points</a></li>
<li class="chapter" data-level="4.3" data-path="wintering.html"><a href="wintering.html#finalize-nonbreeding-nodes"><i class="fa fa-check"></i><b>4.3</b> Finalize nonbreeding nodes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="abundance.html"><a href="abundance.html"><i class="fa fa-check"></i><b>5</b> Relative Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="abundance.html"><a href="abundance.html#get-relative-abundance-for-a-genoscape-raster"><i class="fa fa-check"></i><b>5.1</b> Get relative abundance for a genoscape (raster)</a></li>
<li class="chapter" data-level="5.2" data-path="abundance.html"><a href="abundance.html#get-relative-abundance-for-a-vector"><i class="fa fa-check"></i><b>5.2</b> Get relative abundance for a vector</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="connectivity.html"><a href="connectivity.html"><i class="fa fa-check"></i><b>6</b> Migratory Network Model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="connectivity.html"><a href="connectivity.html#input-data"><i class="fa fa-check"></i><b>6.1</b> Input data</a></li>
<li class="chapter" data-level="6.2" data-path="connectivity.html"><a href="connectivity.html#migratory-network-model-jags"><i class="fa fa-check"></i><b>6.2</b> Migratory network model (JAGS)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="connectivity.html"><a href="connectivity.html#preparing-input-data"><i class="fa fa-check"></i><b>6.2.1</b> Preparing input data</a></li>
<li class="chapter" data-level="6.2.2" data-path="connectivity.html"><a href="connectivity.html#running-the-model"><i class="fa fa-check"></i><b>6.2.2</b> Running the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>7</b> Network visualization</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating Migratory Networks in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="breeding" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Breeding nodes<a href="breeding.html#breeding" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Delineating breeding nodes is necessary for our migratory network model for both 1) assignment among populations, and 2) specifying a region for relative abundance. Here, we show how breeding nodes can be delineated by genetically distinct populations on the breeding grounds. In this example, we’ll show how to use <a href="https://ebird.org/science/status-and-trends">eBird Status and Trends</a> data to specify the breeding range and then use genetic data from admixture analyses to specify the spatial extent of the breeding nodes.</p>
<div id="ebirdst" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> ebirdst<a href="breeding.html#ebirdst" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our migratory network analyses, the <a href="https://science.ebird.org/en/status-and-trends">eBird Status and Trends</a> data is used to delineate the different stages of the annual cycle. Prior to doing anything with eBird Status and Trends data, you will need to download the <code>ebirdst</code> package, and then get access to the data. <strong>You will need to follow the most up-to-date instructions from the <code>ebirdst</code> developers for getting the abundance data. Currently, that information is here: <a href="https://ebird.github.io/ebirdst/">https://ebird.github.io/ebirdst/</a></strong></p>
<p>To download the package:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="breeding.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;remotes&quot;)</span></span>
<span id="cb10-2"><a href="breeding.html#cb10-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;CornellLabofOrnithology/ebirdst&quot;</span>)</span></code></pre></div>
<p>Then, get access to <code>ebirdst</code> data at <a href="https://ebird.org/st/request" class="uri">https://ebird.org/st/request</a>. You will receive a key to download <code>ebirdst</code> data and you can enter that key in R:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="breeding.html#cb11-1" aria-hidden="true" tabindex="-1"></a>ebirdst<span class="sc">::</span><span class="fu">set_ebirdst_access_key</span>(<span class="st">&quot;XXXXX&quot;</span>)</span></code></pre></div>
<p>where <code>"XXXXX"</code> is the key.</p>
<p>By following instructions from the <code>ebirdst</code> developers, you can obtain polygons of the breeding and nonbreeding ranges of avian species (see <a href="https://ebird.github.io/ebirdst/">https://ebird.github.io/ebirdst/</a> for details).</p>
</div>
<div id="creating-the-genoscape" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Creating the genoscape<a href="breeding.html#creating-the-genoscape" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A genoscape is the collection of genetically distinct populations that make up a species’ range <span class="citation">(<a href="#ref-ruegg2021american" role="doc-biblioref">Ruegg et al. 2021</a>)</span>. Typically, for migratory species, the genoscape describes this population structure on the breeding range because the nonbreeding populations can can contain individuals from different breeding populations.</p>
<p>We will outline the main genoscape creation steps here, but full instructions on creating a genoscape map can be found in Eric Anderson’s Github project <a href="https://github.com/eriqande/make-a-BGP-map">Make a Bird Genoscape Project map</a>. The input data needed for a genoscape are:</p>
<ul>
<li>Individual Q-value matrix</li>
<li>Lat/lon matrix of individuals</li>
<li>Breeding range polygon</li>
</ul>
<p>The Q-value matrix is obtained from individual admixture analyses (e.g. Structure, Admixture, <code>snmf</code> fuction from the LEA R-package). Latitude/longitude coordinates are for the individual samples used in the Q-value matrix. Breeding range polygons can be obtained from <code>ebirdst</code> (see previous section).</p>
<p>The <code>comyel_breeding_data</code> data set provides admixture results (Q-values) of five genotype clusters for Common Yellowthroat (cite a coye paper) and metadata for the sampled individuals.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="breeding.html#cb12-1" aria-hidden="true" tabindex="-1"></a>Q_matrix <span class="ot">&lt;-</span> Mignette<span class="sc">::</span>comyel_breeding_data <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="breeding.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(CA, Midwest, NewEngland, West, Southwest) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="breeding.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb12-4"><a href="breeding.html#cb12-4" aria-hidden="true" tabindex="-1"></a>long_lat_matrix <span class="ot">&lt;-</span> Mignette<span class="sc">::</span>comyel_breeding_data <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="breeding.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Long, Lat) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="breeding.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb12-7"><a href="breeding.html#cb12-7" aria-hidden="true" tabindex="-1"></a>cluster_colors <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb12-8"><a href="breeding.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CA =</span> <span class="st">&quot;#CC0000&quot;</span>,</span>
<span id="cb12-9"><a href="breeding.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Midwest =</span> <span class="st">&quot;#3399FF&quot;</span>,</span>
<span id="cb12-10"><a href="breeding.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">NewEngland =</span> <span class="st">&quot;#9933CC&quot;</span>,</span>
<span id="cb12-11"><a href="breeding.html#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">West =</span> <span class="st">&quot;#009933&quot;</span>,</span>
<span id="cb12-12"><a href="breeding.html#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Southwest =</span> <span class="st">&quot;#FF6600&quot;</span>) </span></code></pre></div>
<p>We will use a <a href="https://github.com/eriqande/TESS3_encho_sen">modified version</a> of the <code>tess3r</code> package to create the genoscape rasters.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="breeding.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;eriqande/TESS3_encho_sen&quot;)</span></span>
<span id="cb13-2"><a href="breeding.html#cb13-2" aria-hidden="true" tabindex="-1"></a>genoscape_brick <span class="ot">&lt;-</span> tess3r<span class="sc">::</span><span class="fu">tess3Q_map_rasters</span>(</span>
<span id="cb13-3"><a href="breeding.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> Q_matrix, </span>
<span id="cb13-4"><a href="breeding.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">coord =</span> long_lat_matrix,  </span>
<span id="cb13-5"><a href="breeding.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">map.polygon =</span> breed_smooth,</span>
<span id="cb13-6"><a href="breeding.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">window =</span> terra<span class="sc">::</span><span class="fu">ext</span>(breed_smooth)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb13-7"><a href="breeding.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resolution =</span> <span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">300</span>), <span class="co"># if you want more cells in your raster, set higher</span></span>
<span id="cb13-8"><a href="breeding.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.palette =</span> tess3r<span class="sc">::</span><span class="fu">CreatePalette</span>(cluster_colors, <span class="fu">length</span>(cluster_colors)), </span>
<span id="cb13-9"><a href="breeding.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;map.max&quot;</span>, </span>
<span id="cb13-10"><a href="breeding.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">interpol =</span> tess3r<span class="sc">::</span><span class="fu">FieldsKrigModel</span>(<span class="dv">10</span>),  </span>
<span id="cb13-11"><a href="breeding.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Ancestry coefficients&quot;</span>,</span>
<span id="cb13-12"><a href="breeding.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Longitude&quot;</span>, </span>
<span id="cb13-13"><a href="breeding.html#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Latitude&quot;</span>, </span>
<span id="cb13-14"><a href="breeding.html#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> .<span class="dv">4</span></span>
<span id="cb13-15"><a href="breeding.html#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-16"><a href="breeding.html#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(genoscape_brick) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Q_matrix)</span>
<span id="cb13-17"><a href="breeding.html#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="breeding.html#cb13-18" aria-hidden="true" tabindex="-1"></a>out.files <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;./comyel/genoscape/comyel_genoscape_cluster_&quot;</span>, <span class="fu">names</span>(genoscape_brick), <span class="st">&quot;.tif&quot;</span>)</span>
<span id="cb13-19"><a href="breeding.html#cb13-19" aria-hidden="true" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">writeRaster</span>(terra<span class="sc">::</span><span class="fu">rast</span>(genoscape_brick), <span class="at">filename =</span> out.files)</span></code></pre></div>
<p><strong>STOP</strong></p>
<p>The rasters for the genoscape are all that are needed for obtaining information on relative abundance for the different populations. You can continue on to the <a href="abundance.html#abundance">relative abundance section</a> if you are ready to do that with the genoscape. Or if you still need to create the wintering nodes, check out the <a href="wintering.html#wintering">wintering nodes section</a>. The following section is not necessary for the migratory network but details how to covert genoscape rasters to polygons if the <code>mignette</code> user is interested in doing so.</p>
<div id="genoscape-polygons" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Genoscape polygons<a href="breeding.html#genoscape-polygons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the genoscape rasters we will convert them to polygons, using the handy <code>scape_to_shape()</code> function. The <code>prob_threshold</code> parameter specifies the value to determine if a raster cell is included in the polygon for that genoscape. This value should be customized for different species to check for overlap of genoscape polygons, which is not desirable. Setting too high of a threshold will create very small breeding nodes, while too low of a threshold will result in large, overlapping breeding nodes.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="breeding.html#cb14-1" aria-hidden="true" tabindex="-1"></a>genoscape_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&quot;./comyel/genoscape&quot;</span>, </span>
<span id="cb14-2"><a href="breeding.html#cb14-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">full.names =</span> T,</span>
<span id="cb14-3"><a href="breeding.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">pattern =</span> <span class="st">&quot;*.tif&quot;</span>)</span>
<span id="cb14-4"><a href="breeding.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="breeding.html#cb14-5" aria-hidden="true" tabindex="-1"></a>genoscape_raster_stack <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(genoscape_files)</span>
<span id="cb14-6"><a href="breeding.html#cb14-6" aria-hidden="true" tabindex="-1"></a>genoscape_polygon_sf <span class="ot">&lt;-</span> mignette<span class="sc">::</span><span class="fu">scape_to_shape</span>(<span class="at">x =</span> genoscape_raster_stack, <span class="at">prob_threshold =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>Check out the polygons</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="breeding.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-2"><a href="breeding.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> genoscape_polygon_sf,<span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="breeding.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cluster_colors)</span></code></pre></div>
<p><img src="Mignette_files/figure-html/unnamed-chunk-7-1.png" width="70%" /></p>
<p>Check which polygons are overlapping. Each row of the output provides a pair of overlapping polygons (if there are any).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="breeding.html#cb16-1" aria-hidden="true" tabindex="-1"></a>mignette<span class="sc">::</span><span class="fu">check_genoscape_overlap</span>(genoscape_polygon_sf)</span></code></pre></div>
<pre><code>##      [,1]      [,2]        
## [1,] &quot;CA&quot;      &quot;West&quot;      
## [2,] &quot;Midwest&quot; &quot;NewEngland&quot;
## [3,] &quot;Midwest&quot; &quot;West&quot;</code></pre>
<p>Now on to creating the <a href="wintering.html#wintering">wintering nodes</a></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ruegg2021american" class="csl-entry">
Ruegg, Kristen C, Michaela Brinkmeyer, Christen M Bossu, Rachael A Bay, Eric C Anderson, Clint W Boal, Russell D Dawson, et al. 2021. <span>“The American Kestrel (Falco Sparverius) Genoscape: Implications for Monitoring, Management, and Subspecies Boundaries.”</span> <em>The Auk</em> 138 (2): ukaa051.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quickstart.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wintering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-breedingnodes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Mignette.pdf", "Mignette.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
