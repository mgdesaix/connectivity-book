<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Quick start example | Creating Migratory Networks in R: mignette</title>
  <meta name="description" content="This provides examples and documentation of the Mignette R package" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Quick start example | Creating Migratory Networks in R: mignette" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This provides examples and documentation of the Mignette R package" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Quick start example | Creating Migratory Networks in R: mignette" />
  
  <meta name="twitter:description" content="This provides examples and documentation of the Mignette R package" />
  

<meta name="author" content="" />


<meta name="date" content="2024-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="nodes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Migratory Networks in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#tutorial-structure"><i class="fa fa-check"></i><b>1.1</b> Tutorial structure</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quickstart.html"><a href="quickstart.html"><i class="fa fa-check"></i><b>2</b> Quick start example</a></li>
<li class="chapter" data-level="3" data-path="nodes.html"><a href="nodes.html"><i class="fa fa-check"></i><b>3</b> Define breeding and nonbreeding nodes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nodes.html"><a href="nodes.html#vector-data"><i class="fa fa-check"></i><b>3.1</b> Vector data</a></li>
<li class="chapter" data-level="3.2" data-path="nodes.html"><a href="nodes.html#raster-data"><i class="fa fa-check"></i><b>3.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Assemble abundance and migratory connectivity data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#abundance-data"><i class="fa fa-check"></i><b>4.1</b> Abundance data</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#migratory-connectivity-data"><i class="fa fa-check"></i><b>4.2</b> Migratory connectivity data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model.html"><a href="model.html"><i class="fa fa-check"></i><b>5</b> Modeling the migratory network</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model.html"><a href="model.html#input-data"><i class="fa fa-check"></i><b>5.1</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>6</b> Supplement: Visualizations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualization.html"><a href="visualization.html#alluvial-plot"><i class="fa fa-check"></i><b>6.1</b> Alluvial plot</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i><b>7</b> Supplement: Avian abundance data and genetic breeding nodes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="supplemental.html"><a href="supplemental.html#breeding-nodes"><i class="fa fa-check"></i><b>7.1</b> Breeding nodes</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="supplemental.html"><a href="supplemental.html#ebirdst"><i class="fa fa-check"></i><b>7.1.1</b> ebirdst</a></li>
<li class="chapter" data-level="7.1.2" data-path="supplemental.html"><a href="supplemental.html#creating-the-genoscape"><i class="fa fa-check"></i><b>7.1.2</b> Creating the genoscape</a></li>
<li class="chapter" data-level="7.1.3" data-path="supplemental.html"><a href="supplemental.html#genoscape-polygons"><i class="fa fa-check"></i><b>7.1.3</b> Genoscape polygons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Creating Migratory Networks in R: mignette</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quickstart" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Quick start example<a href="quickstart.html#quickstart" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here, we demonstrate a quick example of how to create a migratory network when the user has all of the data required. To run this tutorial, load the following packages:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="quickstart.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="quickstart.html#cb3-2" tabindex="-1"></a><span class="fu">library</span>(mignette)</span>
<span id="cb3-3"><a href="quickstart.html#cb3-3" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb3-4"><a href="quickstart.html#cb3-4" tabindex="-1"></a><span class="fu">library</span>(jagsUI)</span>
<span id="cb3-5"><a href="quickstart.html#cb3-5" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span></code></pre></div>
<p>The data required are:</p>
<ul>
<li>Abundance</li>
<li>Migratory connectivity</li>
</ul>
<p>We provide an example of these data in <code>mignette</code>, with migratory connectivity data from 5 breeding nodes (WB = Western Boreal, NT = Northern Temperate, ST = Southern Temperate, BR = Basin Rockies, MP = Maritime Provinces) and 5 nonbreeding nodes (ALM = Atlantic Lowland Mexico, CAR = Caribbean, AONU = Amazon/Orinoco-Northern Uplands, HCA = Highland Central America, LCA = Lowland Central America) for the American Redstart (<em>Setophaga ruticilla</em>). The migratory connectivity data specifies the number of individuals that have been sampled or detected that migrate between different populations (i.e. <em>connect</em> the nodes).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="quickstart.html#cb4-1" tabindex="-1"></a>mignette<span class="sc">::</span>amre_assign</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Breeding</th>
<th align="right">CAR</th>
<th align="right">AONU</th>
<th align="right">ALM</th>
<th align="right">HCA</th>
<th align="right">LCA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BR</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">MP</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">NT</td>
<td align="right">54</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ST</td>
<td align="right">12</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">WB</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">1</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<p>We also provide the abundance of these nodes:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="quickstart.html#cb5-1" tabindex="-1"></a>mignette<span class="sc">::</span>amre_abundance</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Population</th>
<th align="right">Relative_abundance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BR</td>
<td align="right">2403</td>
</tr>
<tr class="even">
<td align="left">ST</td>
<td align="right">9419</td>
</tr>
<tr class="odd">
<td align="left">MP</td>
<td align="right">19011</td>
</tr>
<tr class="even">
<td align="left">NT</td>
<td align="right">72147</td>
</tr>
<tr class="odd">
<td align="left">WB</td>
<td align="right">26080</td>
</tr>
<tr class="even">
<td align="left">HCA</td>
<td align="right">326</td>
</tr>
<tr class="odd">
<td align="left">AONU</td>
<td align="right">1139</td>
</tr>
<tr class="even">
<td align="left">LCA</td>
<td align="right">2802</td>
</tr>
<tr class="odd">
<td align="left">ALM</td>
<td align="right">3169</td>
</tr>
<tr class="even">
<td align="left">CAR</td>
<td align="right">7987</td>
</tr>
</tbody>
</table>
<p><strong>Network model</strong></p>
<p>For the following functions, we specify the order of the nodes we are using for the model. Here, we are just ordering nodes geographically by longitude to facilitate straightforward interpretation of the output.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="quickstart.html#cb6-1" tabindex="-1"></a>brnode_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WB&quot;</span>, <span class="st">&quot;BR&quot;</span>, <span class="st">&quot;NT&quot;</span>, <span class="st">&quot;ST&quot;</span>, <span class="st">&quot;MP&quot;</span>)</span>
<span id="cb6-2"><a href="quickstart.html#cb6-2" tabindex="-1"></a>nbnode_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ALM&quot;</span>, <span class="st">&quot;LCA&quot;</span>, <span class="st">&quot;HCA&quot;</span>, <span class="st">&quot;CAR&quot;</span>, <span class="st">&quot;AONU&quot;</span>)</span></code></pre></div>
<p>For the American Redstart migratory network, we use <code>model = BR</code> which specifies that nonbreeding nodes are the “encounter” season and breeding nodes are the “recovery” season (i.e., inferred). This output saves the model as <code>amre.genetic.model_BR.txt</code>. Below we specify <code>parallel = TRUE</code> to run MCMC on multiple cores and use the remaining defaults. This step is computationally intensive and takes ~2 minutes to run on a 2023 MacBook Pro with an Apple M2 Pro chip.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="quickstart.html#cb7-1" tabindex="-1"></a>network_model <span class="ot">&lt;-</span> <span class="fu">run_network_model</span>(<span class="at">abundance =</span> amre_abundance, </span>
<span id="cb7-2"><a href="quickstart.html#cb7-2" tabindex="-1"></a>                           <span class="at">nb2br_assign =</span> amre_assign,</span>
<span id="cb7-3"><a href="quickstart.html#cb7-3" tabindex="-1"></a>                           <span class="at">brnode_names =</span> brnode_names, </span>
<span id="cb7-4"><a href="quickstart.html#cb7-4" tabindex="-1"></a>                           <span class="at">nbnode_names =</span> nbnode_names,</span>
<span id="cb7-5"><a href="quickstart.html#cb7-5" tabindex="-1"></a>                           <span class="at">model =</span> <span class="st">&quot;BR&quot;</span>, <span class="at">base_filename =</span> <span class="st">&quot;amre.genetic&quot;</span>,</span>
<span id="cb7-6"><a href="quickstart.html#cb7-6" tabindex="-1"></a>                           <span class="at">parallel =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The first component of the output, <code>[[“conn”]]</code>, is an R tibble object of the mean connectivity estimated between nodes (Table 1). These values are interpreted as the proportion of the global population that migrate between the corresponding populations, as such all of the values in the network matrix sum to one. The second component, <code>[[“jags_out”]]</code>, is the full output from <code>jagsUI::autojags()</code> provided as a list object, which contains important model information such as parameter estimates and credible intervals, model specifications, and goodness of fit. The final two components, <code>[[“brnode_names”]]</code> and <code>[[“nbnode_names”]]</code>, store the node names corresponding to the rows and columns, respectively, of the connectivity matrix.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="quickstart.html#cb8-1" tabindex="-1"></a>network_model<span class="sc">$</span>conn</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Breeding</th>
<th align="right">ALM</th>
<th align="right">LCA</th>
<th align="right">HCA</th>
<th align="right">CAR</th>
<th align="right">AONU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">WB</td>
<td align="right">0.14212</td>
<td align="right">0.13901</td>
<td align="right">0.01346</td>
<td align="right">0.00507</td>
<td align="right">0.00002</td>
</tr>
<tr class="even">
<td align="left">BR</td>
<td align="right">0.00010</td>
<td align="right">0.00021</td>
<td align="right">0.00008</td>
<td align="right">0.02082</td>
<td align="right">0.00004</td>
</tr>
<tr class="odd">
<td align="left">NT</td>
<td align="right">0.05680</td>
<td align="right">0.00041</td>
<td align="right">0.00013</td>
<td align="right">0.38276</td>
<td align="right">0.00006</td>
</tr>
<tr class="even">
<td align="left">ST</td>
<td align="right">0.00003</td>
<td align="right">0.01345</td>
<td align="right">0.03618</td>
<td align="right">0.03902</td>
<td align="right">0.06453</td>
</tr>
<tr class="odd">
<td align="left">MP</td>
<td align="right">0.00013</td>
<td align="right">0.00036</td>
<td align="right">0.00022</td>
<td align="right">0.00002</td>
<td align="right">0.08496</td>
</tr>
</tbody>
</table>
<p>The second component is the full output from <a href="https://rdrr.io/cran/jagsUI/man/autojags.html"><code>*jagsUI* autojags()</code></a> and is accessed by <code>network_model$jags_out</code>. Here, the raw connectivity matrix (i.e., mean <em>conn_g</em> estimates) can be accessed:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="quickstart.html#cb9-1" tabindex="-1"></a>amre_conn <span class="ot">&lt;-</span> network_model<span class="sc">$</span>jags_out<span class="sc">$</span>mean<span class="sc">$</span>conn_g</span>
<span id="cb9-2"><a href="quickstart.html#cb9-2" tabindex="-1"></a>amre_conn</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.14212</td>
<td align="right">0.13901</td>
<td align="right">0.01346</td>
<td align="right">0.00507</td>
<td align="right">0.00002</td>
</tr>
<tr class="even">
<td align="right">0.00010</td>
<td align="right">0.00021</td>
<td align="right">0.00008</td>
<td align="right">0.02082</td>
<td align="right">0.00004</td>
</tr>
<tr class="odd">
<td align="right">0.05680</td>
<td align="right">0.00041</td>
<td align="right">0.00013</td>
<td align="right">0.38276</td>
<td align="right">0.00006</td>
</tr>
<tr class="even">
<td align="right">0.00003</td>
<td align="right">0.01345</td>
<td align="right">0.03618</td>
<td align="right">0.03902</td>
<td align="right">0.06453</td>
</tr>
<tr class="odd">
<td align="right">0.00013</td>
<td align="right">0.00036</td>
<td align="right">0.00022</td>
<td align="right">0.00002</td>
<td align="right">0.08496</td>
</tr>
</tbody>
</table>
<p><strong>Check parameter convergence</strong></p>
<p><code>mignette</code> users should familiarize themselves with the <a href="https://rdrr.io/cran/jagsUI/man/autojags.html"><code>jagsUI autojags()</code></a> output in order to evaluate the network model appropriately. For example, all parameters of the model should converge (<em>Rhat</em> &lt; 1.1) and this can be double-checked by counting the number of instances where there are <em>Rhat</em> values greater than or equal to 1.1 with:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="quickstart.html#cb10-1" tabindex="-1"></a><span class="fu">sum</span>(network_model<span class="sc">$</span>jags_out<span class="sc">$</span>Rhat<span class="sc">$</span>conn_g <span class="sc">&gt;=</span> <span class="fl">1.1</span>)</span>
<span id="cb10-2"><a href="quickstart.html#cb10-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span></span></code></pre></div>
<p>In this case, all of the <em>Rhat</em> values for the connectivity estimates were less than 1.1 and thus the result was 0 - all parameters converged! In the absence of convergence, the MCMC iterations may need to be increased. Additionally, convergence should be inspected visually to ensure that all MCMC chains have stabilized.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="quickstart.html#cb11-1" tabindex="-1"></a>jagsUI<span class="sc">::</span><span class="fu">traceplot</span>(network_model<span class="sc">$</span>jags_out, <span class="st">&quot;conn&quot;</span>, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="images/mcmc_chains1.png" width="317" /></p>
<p><strong>Check goodness of fit</strong></p>
<p>In <em>mignette</em>, we implement a posterior predictive check using the Freeman-Tukey discrepancy statistic to compare the fit of the observed data to simulated data from the model, following the guidelines of <a href="https://doi.org/10.1002/ecm.1314">Conn et al. (2018)</a>. In the network model output, the posterior predictive check parameters are: 1) FT.obs = the Freeman-Tukey statistic for observed data, and 2) FT.rep = the Freeman-Tukey statistic for simulated data. The function <code>get_FT_fit()</code> produces a density plot of the Freeman-Tukey statistics for qualitatively comparing observed and simulated data, as well as outputting the Bayesian p-value of the goodness of fit based on these distributions. Very small (&lt;0.05) or large (&gt;0.95) Bayesian p-values suggest a lack of fit of the model. For a full discussion of checking Bayesian models, see Conn et al. (2018).</p>
<p>We can then look at the posterior predictive check of the American Redstart mode using the code below, which shows largely overlapping distributions of the Freeman-Tukey discrepancy statistics for the observed and simulated data, with a corresponding Bayesian p-value of 0.58 - indicating sufficient goodness of fit.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="quickstart.html#cb12-1" tabindex="-1"></a><span class="fu">get_FT_fit</span>(network_model)</span></code></pre></div>
<p><img src="images/p.fit.png" width="900" /></p>
<p><strong>Uncertainty in the connectivity estimates</strong></p>
<p>The network model output provides credible intervals in addition to the mean of the connectivity estimates. Uncertainty in the network connectivity estimates is characterized by the credible intervals provided in the network model output for the conn_g parameter. The mignette function <code>plot_network_CI()</code> plots the mean and 95% credible intervals for network connectivity which allows users to assess the uncertainty in the estimates.</p>
<pre><code>plot_network_CI(network_model = network_model, stage = “Breeding”, 
stage_colors = brnode_colors, overlap = TRUE)</code></pre>
<p><img src="images/p.ci.png" width="900" /></p>
<p><strong>Visualize network</strong></p>
<p>The raw connectivity matrix is used to plot the network. We plot the migratory network with the provided <code>mignette</code> functions <code>net_create()</code> and <code>net_draw()</code>. We set <code>connected_tol = 0.01</code> which plots only the edges with connectivity values of greater than 0.01.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="quickstart.html#cb14-1" tabindex="-1"></a>amre_net <span class="ot">&lt;-</span> <span class="fu">net_create</span>(<span class="at">network_model =</span> network_model,</span>
<span id="cb14-2"><a href="quickstart.html#cb14-2" tabindex="-1"></a>                       <span class="at">margin =</span> <span class="fl">0.05</span>)</span>
<span id="cb14-3"><a href="quickstart.html#cb14-3" tabindex="-1"></a><span class="co">#set the display size range for nodes (min and max), default 1-10</span></span>
<span id="cb14-4"><a href="quickstart.html#cb14-4" tabindex="-1"></a>amre_net<span class="sc">$</span>display_par<span class="sc">$</span>node_size_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">25</span>)</span>
<span id="cb14-5"><a href="quickstart.html#cb14-5" tabindex="-1"></a><span class="co">#set the display size range for edges (min and max), default 1-10</span></span>
<span id="cb14-6"><a href="quickstart.html#cb14-6" tabindex="-1"></a>amre_net<span class="sc">$</span>display_par<span class="sc">$</span>edge_size_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb14-7"><a href="quickstart.html#cb14-7" tabindex="-1"></a><span class="co"># change colors</span></span>
<span id="cb14-8"><a href="quickstart.html#cb14-8" tabindex="-1"></a>amre_net<span class="sc">$</span>display_par<span class="sc">$</span>brnode_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#009e73&quot;</span>, <span class="st">&quot;#cc79a7&quot;</span>, <span class="st">&quot;#56b4e9&quot;</span>, <span class="st">&quot;#e69f00&quot;</span>, <span class="st">&quot;#7979ff&quot;</span>)</span>
<span id="cb14-9"><a href="quickstart.html#cb14-9" tabindex="-1"></a>amre_net<span class="sc">$</span>display_par<span class="sc">$</span>nbnode_colors <span class="ot">&lt;-</span> <span class="st">&quot;grey80&quot;</span></span>
<span id="cb14-10"><a href="quickstart.html#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="quickstart.html#cb14-11" tabindex="-1"></a><span class="fu">net_draw</span>(amre_net)</span></code></pre></div>
<p><img src="images/p.amre.net.png" width="1050" /></p>
<p>In this visualization, node size corresponds to the amount of connectivity with that population and edge size corresponds to the amount of connectivity between the populations. Breeding populations are in the top row, for which we provided custom colors, and nonbreeding populations are in the bottom row.</p>
<p>This sums up the basics of creating and visualizing a migratory network. We encourage users to explore and build upon the visualization tools we provide (e.g. overlay the migratory networks on geographic ranges) - the options are endless, enjoy!</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nodes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/00-quickstart.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Mignette.pdf", "Mignette.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
